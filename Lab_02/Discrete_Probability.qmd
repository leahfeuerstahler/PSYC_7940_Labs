---
title: "Lab 2: Discrete Probability"
date: January 28, 2026
---

## Introduction

This week, we will use `ggplot` to visualize data:

-   Visualize descriptive statistics

-   Simple simulation studies

-   Visualize simulated data

-   Discrete distributions in R

## `ggplot` Introduction

-   Load the `tidyverse` package, which will load the `ggplot2` and other packages.

```{r}
library(tidyverse)
```

-   Read Data into `R`

    - Some datasets are including in R packages, such as the `iris` data:
    
```{r}
data <- iris
```

    -   Also download the `Titanic_Survival.csv` file from Blackboard and load it into your `R` session:

```{r}
data2 <- read_csv("Titanic_Survival.csv")
```

## Descriptive Statistics

-   Visualization is an essential tool to understand your data.

-   To use `ggplot` to create a scatterplot , we need to specify dataset, $x$-axis and $y$-axis

```{r}
ggplot(data, aes(x = Sepal.Length, y = Sepal.Width))
```

An empty plot!

## Descriptive Statistics

-   **Add** types of plot we want, for example:

```{r}
ggplot(data, aes(x = Sepal.Length, y = Sepal.Width))+
  geom_point()
```

## Descriptive Statistics

-   To make a barplot, only `x` aesthetic is needed:

```{r}
ggplot(data, aes(x = Species))+ geom_bar()
```

## Descriptive Statistics

-   To learn more about different methods, we can check the help page by:

```{r eval = FALSE}
?ggplot
```

-   If you have any question on any command, looking at the help page (`?`) is a good start. 

## Simulation and Visualizing PMFs

-   This section covers topics below:
    -   Bernoulli distribution
    -   Binomial distribution
    -   Multinomial distribution
-   In this section, we will talk about how to visualize discrete distributions using probability mass functions (PMFs).

## Functions in `R`

-   In R, many stats functions have already been installed:

```{r eval = FALSE}
rbinom() #Generate random binomial data
rmultinom() # Generate random multinomial data
```

-   In R, the command names are usually defined by `r`, `d`, `q` plus simplified function name like `binom`, `norm` or `lnorm`.

    -   `r` means "randomly sample from the function". This function can be used to generate data from a specific distribution.
    -   `d` means "density". It gives the probability of an outcome (discrete functions only).
    -   `q` means "quantile". It gives the quantile associated with a given probability.
    -   `p` cumulative distribution function. It gives the probability of an outcome at or below a quantile. This is the inverse function of `q`.

## Functions in `R`

-   Still, if you have any questions, use...

```{r eval = F}
?rbinom
```

-   You can find the information for `rbinom`, `pbinom`. `qbinom` and `rbinom` in the same help page.

## Simulation

-   There are two ways to generate large discrete datasets from `R`:

    - `sample`
    - Distribution-specific functions like `rbinom`

## Simulation with `sample`

The following code generates 10,000 0's and 1's where 1 is drawn with probability 1/6. We can imagine this as the probability of rolling a 6 on a die.

```{r}
samples <- sample(x = c(0,1), # values to sample
            size = 1e4, # how many samples to draw
            replace = TRUE, # sample WITH replacement (allow repeats)
            prob = c(5/6, 1/6)) # probability for each outcome

```

Because this is a random sampling process, we may get different results every time we run the code. If we want to perfectly replicate a simulation process, we can use `set.seed` before generating data.

```{r}
set.seed(8765)

samples <- sample(x = c(0,1), 
                  size = 1e4, 
                  replace = TRUE, 
                  prob = c(5/6, 1/6)) 
```

## Visualize the Result

```{r}
samples<-as.data.frame(samples)
ggplot(samples, aes(x=samples))+ geom_bar()
```


## An Equivalent Method to Simulate Data

```{r}
samples2<-rbinom(1e4, size = 1, prob = 1/6)
samples2<-data.frame(samples2)
ggplot(samples2, aes(x=samples2))+ geom_bar()
```

## Other Discrete Distributions

The previous example sampled from the Bernoulli distribution, which describe an event with dichotomous (0/1) outcome.

* `size = 1` indicates 1 observation, `prob` is the fixed probability of "event =1".

```{r}
dbinom(x=c(0,1), size = 1, prob = 1/6)
```

-   The result shows probability of "event =0" and probability of "event =1". The probability of "event =2" is 0, because it is not one of the possible outcomes.

* If you roll 1 die, you cannot observe 2 6's.

```{r}
dbinom(c(0,1,2), size = 1, prob = 1/6)
```

## Other Discrete Distributions

The binomial distribution is a generalization of the Bernoulli distribution that allows for greater values of `size` (e.g., rolling more dice).

```{r}
dbinom(c(0,1,2), size = 2, prob = 1/6)
```

The result shows if the probability of 0, 1, or 2 independent events if the probability of a single event is 1/6. 

* For example, above represents the number of 6's if you roll 2 dice.

## Other Discrete Distributions

-  The binomial distribution generalized to the multinomial distribution. In the binomial distribution, we have several observations of dichotomous events (0/1). However, in the multinomial distribution, the range of events extends to $n$ categories, "event =(1, 2, ..., $n$)".

-   The sum of probabilities for individual events equals 1.

-   Each event is independent to each other.

-   For example, if the event has three categories (1, 2, 3), the probability of each event is 1/3, and we make 1 observation, what is the probability of observing the first event twice?

```{r}
dmultinom(c(2,0,0), size = 2, prob = c(1/3, 1/3, 1/3))
```

## Other Discrete Distributions

-   We can generalize the multinomial distribution to more complicated conditions. For example in lecture:

```{r}
dmultinom(x = c(5, 0, 0), size = 5,
          prob = c(.3716564, .3357767, .2925669))
```

**How to interpret this result?**

## Other Discrete Distributions

-   Negative Binomial Distribution

    -   For a series of Bernoulli trials with a certain probability of "event = 1", what is the probability that "event = 1" occurs `size` number of times before we observe "event = 0" `x` times?
    
```{r}
dnbinom(x=2, size=1, prob=0.3)
```

You can also use `mu` to code the `dnbinom`, as we learned:
    
$$\mu = (1-prob) * size/prob$$
```{r}
mu<- (1-0.3)*1/0.3
dnbinom(x=2, size=1, mu = mu)
```

## Other Discrete Distributions

-   Poisson Distribution

    -   The Poisson represents how many times "event = 1" occured in a certain time interval, if the average rate of "event = 1" is a constant $\lambda$. 
    
```{r}
dpois(x = 1, lambda = 5)
```

## Simulation from Poisson Distribution

```{r}
set.seed(8656)

samples_pois<-rpois(n = 1e5, lambda = 5) #Simulate dataset

samples_pois<-data.frame(samples_pois) #Make it a data.frame
```

```{r}
ggplot(samples_pois, aes(x=samples_pois))+
  geom_bar() #Get the plot
```

## Simulation from Poisson Distribution

We can verify the probability using:

```{r}
mean(samples_pois==1) 
```

## Activity Part 1

-    Pick one distribution of interest below, simulate 10,000 observations with parameters (e.g., probability) of your choice. Visualize your simulated dataset.
    
       -    Bernoulli distribution
    
       -    Binomial distribution
       
       -    Negative binomial distribution
       
       -    Poisson distribution
    
       -    Multinomial distribution (Difficult)
       
            -   If you simulate data from multinomial distribution, you will get a matrix instead of a vector. How can you visualize the matrix using ggplot2?
            -   It needs command not covered in the lab. Feel free to use help page and google. Find your own way out!
       
## Activity Part 1

**Tips**
```{r eval=F}
#Sum rows or columns value
rowSums()
colSums()

#Transpose matrix
t()

#Making data.frame
data.frame()
as.data.frame()
```

## Activity Part 2

Consider the following variables in the Titanic data (`data2` that you imported earlier). 

* `pclass`: 1 = 1st class, 2 = 2nd class, 3 = 3rd class
* `survived`: 1 = yes, 0 = no
* `sex`: female, male
* `age`: in years

Test out ways to visualize these data. Feel free to consider types of plots that we did not explicitly learn about in this class!
