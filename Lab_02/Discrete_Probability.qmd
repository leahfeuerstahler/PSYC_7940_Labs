---
title: "Lab 2: Discrete Probability"
date: January 28, 2026
---

## Introduction

This week, we will use `ggplot` to visualize data:

-   Visualize descriptive statistics

-   Simulation 

-   Visualize simulated data

-   Introduction of several discrete distributions in R

## `ggplot` introduction

-   Let's load the package

```{r}
library(ggplot2)
```

-   Load the dataset

    -   If the dataset is installed within Rstudio or a specific package, we can load the dataset by its name
    -   If the dataset (.csv file) is from local folder, we should input the dataset by code
    
```{r}
data <- iris
#data <- ("[dataset name]", package = "[name of package]")
```

```{r}
data2 <- read.csv("Titanic_Survival.csv")
#data2 <- read.delim("[file name]") 
#Use this code if the dataset is .txt file
```

## Descriptive statistics

-   Once we have a dataset and want to understand features of it, visualization is essential.

-   To use `ggplot` to visualize, we need to specify dataset, x-axis and y-axis

```{r eval = F}
ggplot(data, aes(x = Sepal.Length, y = Sepal.Width))
```

-   **Add** types of plot we want, for example

```{r eval = F}
ggplot(data, aes(x = Sepal.Length, y = Sepal.Width))+
  geom_point()
```

## Descriptive Statistics


\begin{center}
\includegraphics[width=0.85\textwidth]{Fig1}
\end{center}

## Descriptive statistics

-   To make a barplot:

```{r eval = F}
ggplot(data, aes(Species))+
  geom_bar()
```


\begin{center}
\includegraphics[width=0.4\textwidth]{Fig2}
\end{center}

## Descriptive Statistics

-   I am not going through all the codes related to descriptive statistics. For more information, we can check the help page by:

```{r eval = F}
?ggplot
```

-   If you have any question on any command, help page (`?`) is a good start

## Simulation and visualizing PMF

\large

-   This section covers topics below:
    -   Bernoulli Distribution
    -   Binomial Distribution
    -   Multinomial Distribution
-   In this section, we will talk about how to visualize discrete distributions using probability mess functions

## Functions in R

-   In R, many stats functions have already been installed:

```{r eval=F}
rbinom() #Binomial function
rmultinom() #Multibinomial function
```

-   In basic R, the command names are usually defined by `r`, `d`, `q` plus simplified function name like `binom`, `norm` or `lnorm`.

    -   `r` means "randomly sample from the function". This function can be used to generate large hypothetical datasets.
    -   `d` means "density". It gives the probability when we use a discrete function
    -   `q` means "quantile". It gives the quantile associated with a given probability
    -   `p` cumulative distribution function, This is the inverse function of `q`

## Functions in R

-   Still, if you have any questions, use...

```{r eval = F}
?rlnorm
```

-   You can find the information of `rlnorm`, `dlnorm`. `plnorm` and `qlnorm` in the help page

## Simulation

-   There are two ways to generate large datasets from R:

    -   `sample`
    -   Installed functions like `rbinom`

## Simulation with `sample`

```{r}
samples <- sample(x = c(0,1), # values to sample
size = 1e4, # how many samples to draw
replace = TRUE, # sample WITH replacement (allow repeats)
prob = c(5/6, 1/6)) # same probability for each observation

```

Because this is a random sampling process, we may get different results every time we run the code. If we want to perfectly replicate a simulation process, we can use `set.seed` before generating data

```{r}
set.seed(8765)

samples <- sample(x = c(0,1), 
size = 1e4, 
replace = TRUE, 
prob = c(5/6, 1/6)) 
```

## Visualize the result

```{r eval=F}
samples<-as.data.frame(samples)
ggplot(samples, aes(x=samples))+
  geom_bar()
```


\begin{center}
\includegraphics[width=0.4\textwidth]{Fig3}
\end{center}

## Another method to simulate data

```{r eval=F}
samples2<-rbinom(1e4, size = 1, prob = 1/6)
samples2<-data.frame(samples2)
ggplot(samples2, aes(x=samples2))+
  geom_bar()
```


\begin{center}
\includegraphics[width=0.4\textwidth]{Fig3}
\end{center}

## Some other useful discrete distributions

-   The example we used in previous slides focus on bernoulli distribution which describe an event with dichotomous (0/1) result. In command `dbinom`, `size = 1` represents one observation, `prob` is the fixed probability of "event = 1".

```{r}
dbinom(x=c(0,1), size = 1, prob = 1/6)
```

-   The result shows probability of "event = 0" and probability of "event = 1". We can see the probability of "event = 2" is 0, although it makes no sense theoretically. Because we have only one observation:

```{r}
dbinom(c(0,1,2), size = 1, prob = 1/6)
```

## Some other useful discrete distributions

-   Once we free the value of `size`, which means we have more than one observation, we have a binomial distribution:

```{r}
dbinom(c(0,1,2), size = 2, prob = 1/6)
```

-   The result shows if the probabiity of "event = 1" is fixed to 1/6, what the probability of 0, 1 or 2 times "event = 1" will be if we have 2 independent observations.

-   We can change the parameter as we want. But it makes no sense if `x` \> `size`.

## Some other useful discrete distributions

-   We can generalize the Binomial distribution to multinomial distribution. In binomial distribution, we have several observations of dichotomized events (0/1). However, in the multinomial distribution, the range of event extended to $n$ categories, "event = $1, 2, ..., n$".

-   The sum of probability for each event is 1.

-   Each event is independent to each other.

-   For example, if the event has three categories ($1, 2, 3$), the probability of each event is $1/3$, and we only observe 1 time, what is the probability of the observation of "event = $2$":

```{r}
dmultinom(c(0,1,0), size = 1, prob = c(1/3,1/3,1/3))
```

## Some other useful discrete distributions

It is noteworthy that the argument `prob` is not true probability but **support** or **likelihood**. For example, if the values of `prob` do not sum up to 1, we can still get the proportional result:

```{r}
dmultinom(c(0,1,0), size = 1, prob = c(1,1,1))
```

## Some other useful discrete distributions

-   We can generalize it to a complicated condition, for example in the lecture

```{r}
dmultinom(x = c(5, 0, 0), size = 5,
prob = c(.3716564, .3357767, .2925669))
```

**How to interpret the code of multinomial distribution?**

## Some other useful discrete distributions

-   Negative Binomial Distribution

    -   It means with a series of Bernoulli trials with certain probability of "event = 1", what is the probability of `size` times "event = 1" before x times "event = 0".
    
```{r}
dnbinom(x=2, size=1, prob=0.3)
```

Of course, you can use `mu` to code the `dnbinom`, as we learned:
    
$$\mu = (1-prob) * size/prob$$
```{r}
mu<- (1-0.3)*1/0.3
dnbinom(x=2, size=1, mu = mu)
```

## Some other useful discrete distribution

-   Poisson Distribution

    -   It represents the number of "event = 1" occured in a certain time interval, if the average rate of "event = 1" is a constant $\lambda$. 
    
```{r}
dpois(1, 5)
```

## Simulation example using poisson distribution

```{r}
set.seed(8656)

samples_pois<-rpois(1e5, lambda = 5) #Simulate dataset

samples_pois<-data.frame(samples_pois) #Make it a data.frame
```

```{r eval=F}
ggplot(samples_pois, aes(x=samples_pois))+
  geom_bar() #Get the plot
```

## Simulation example using poisson distribution

\begin{center}
\includegraphics[width=0.6\textwidth]{Fig4}
\end{center}

## Simulation example using poisson distribution

We can verify the probability using:

```{r}
mean(samples_pois==1) 
```

## Activity

-    Pick one distribution of interest below, simulate 10000 random data with any parameters set, and visualize your simulated dataset.
    
       -    Bernoulli distribution
    
       -    Binomial distribution
    
       -    Multinomial distribution (Difficult)
       
            -   If you simulate data from multinomial distribution, you will get a matrix instead of a vector. How will you visualize the matrix using ggplot2?
            -   It needs command not covered in the lab. Feel free to use help page and google. Find your own way out!
       

-   What do the x-axis and y-axis represent in the figure?

## Activity

**Tips**
```{r eval=F}
#Sum rows or columns value
rowSums()
colSums()

#Transpose matrix
t()

#Making data.frame
data.frame()
as.data.frame()
```
